{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://edu.local/schemas/lesson.schema.json",
  "title": "Normalized Lesson",
  "description": "Schema canônico para aulas normalizadas consumidas pelos renderizadores MD3.",
  "type": "object",
  "additionalProperties": true,
  "required": ["id", "title", "content"],
  "properties": {
    "formatVersion": {
      "type": "string",
      "enum": ["md3.lesson.v1"],
      "description": "Versão da estrutura de aula normalizada."
    },
    "id": {
      "type": "string",
      "pattern": "^lesson-[0-9]{2,}$",
      "description": "Identificador único da aula alinhado ao arquivo no disco (ex.: lesson-01)."
    },
    "slug": {
      "type": "string",
      "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$",
      "description": "Slug amigável usado em rotas ou âncoras públicas."
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "description": "Título apresentado na navegação e cabeçalho da aula."
    },
    "summary": {
      "type": "string",
      "minLength": 1,
      "description": "Descrição curta (1-2 parágrafos) que contextualiza a aula."
    },
    "objective": {
      "type": "string",
      "description": "Objetivo principal herdado do legado."
    },
    "objectives": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Lista de objetivos específicos alinhados à BNCC/ABED."
    },
    "competencies": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Competências estruturantes trabalhadas na aula."
    },
    "skills": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Habilidades mensuráveis que o estudante deve demonstrar."
    },
    "outcomes": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Resultados de aprendizagem observáveis usados em avaliações."
    },
    "prerequisites": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Tópicos ou materiais que o estudante precisa revisar antes da aula."
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$"
      },
      "uniqueItems": true,
      "description": "Marcadores usados em filtros e relatórios."
    },
    "duration": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "Duração estimada em minutos para atividades síncronas/assíncronas."
    },
    "modality": {
      "type": "string",
      "enum": ["in-person", "remote", "hybrid", "async"],
      "description": "Modalidade principal de entrega da aula."
    },
    "resources": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": true,
        "required": ["label", "url"],
        "properties": {
          "label": {
            "type": "string",
            "minLength": 1
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "type": {
            "type": "string",
            "minLength": 1
          }
        }
      },
      "description": "Materiais complementares obrigatórios da aula."
    },
    "bibliography": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "string",
        "minLength": 1
      },
      "description": "Referências bibliográficas formatadas."
    },
    "assessment": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "type": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "rubric": {
          "type": "string",
          "minLength": 1
        }
      },
      "description": "Resumo da estratégia avaliativa vinculada à aula."
    },
    "content": {
      "type": "array",
      "minItems": 1,
      "description": "Blocos semânticos renderizados pelos componentes MD3.",
      "items": {
        "type": "object",
        "additionalProperties": true,
        "required": ["type"],
        "properties": {
          "type": {
            "type": "string",
            "minLength": 1,
            "description": "Identificador do componente responsável por renderizar o bloco."
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "status": {
          "type": "string",
          "enum": ["draft", "in-review", "published"]
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        },
        "owners": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "sources": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        }
      },
      "description": "Metadados operacionais usados por governança e pipelines."
    }
  }
}
