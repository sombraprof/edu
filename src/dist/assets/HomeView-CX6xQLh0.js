import{d as V,r as y,c as S,n as j,_ as C,a as A,b as v,o as f,w as x,e as c,f as w,t as h,g as _,h as T,i as B,j as $,k as D,l as b,m as L,F as k,p as E,u as q,q as P,s as F}from"./index-6tz7n0Hg.js";import{G,a as M}from"./GlobalLoader-CQEiVoIX.js";import{S as N}from"./SectionBlock-DQefd07z.js";const O=e=>{window.__LESSONS_META=e;const o={};e.forEach(s=>{const t=s.unidade||"Lessons";o[t]||(o[t]=[]),o[t].push(s)});const r=[];return Object.keys(o).sort((s,t)=>s.localeCompare(t,"pt")).forEach(s=>{o[s].forEach(t=>{const l=(t.arquivo||"").replace(/\.html$/i,"");r.push({id:l,title:t.titulo,description:t.descricao,status:t.ativo?"available":"soon",unit:s,ativo:t.ativo})})}),r},R=e=>(window.__EXERCISES_META=e,e.map(o=>({id:(o.arquivo||"").replace(/\.json$/i,""),title:o.titulo,description:o.descricao,progress:0,progressText:"Loading progress..."}))),z=V("data",()=>{const e=y(!0),o=y(null),r=y([]),s=y([]),t=y([]),l=y([]),p=S(()=>{const a={};return t.value.forEach(m=>{const n=m.unit||"Lessons";a[n]||(a[n]=[]),a[n].push(m)}),a});return{loading:e,error:o,lessons:r,exercises:s,filteredLessons:t,filteredExercises:l,groupedFilteredLessons:p,applyFilters:a=>{a==="all"?(t.value=[...r.value],l.value=[...s.value]):a==="lessons"?(t.value=[...r.value],l.value=[]):a==="exercises"&&(t.value=[],l.value=[...s.value])},loadData:async()=>{if(r.value.length>0&&s.value.length>0){e.value=!1;return}try{e.value=!0,o.value=null;const[a,m]=await Promise.all([fetch("lessons/lessons.json"),fetch("exercises/exercises.json")]);if(!a.ok)throw new Error("Failed to load lessons.");if(!m.ok)throw new Error("Failed to load exercises.");const n=await a.json(),u=await m.json();r.value=O(n),s.value=R(u),t.value=[...r.value],l.value=[...s.value]}catch(a){console.error("Failed to load data store:",a),o.value=a.message}finally{e.value=!1}}}});function I(){const e=async(s,t={})=>{const{groupDelay:l=120,itemDelay:p=40}=t;await j(),document.querySelectorAll(s).forEach((d,a)=>{Array.from(d.children).forEach((n,u)=>{const g=a*l+u*p;n.style.setProperty("--stagger-delay",`${g}ms`)})})},o=(s,t="layout-fade",l=200)=>{document.querySelectorAll(s).forEach(i=>{i.classList.add(t),setTimeout(()=>{i.classList.remove(t)},l)})};return{applyStagger:e,applyLayoutTransition:o,animateContainer:async(s,t={})=>{o(s),await e(s,t)}}}const H=A({name:"LessonCard",props:{lesson:{type:Object,required:!0}},setup(){return{}}}),J={class:"flex flex-col items-start gap-2"},K={class:"leading-none"};function U(e,o,r,s,t,l){const p=_("router-link");return f(),v(p,{to:`/lesson/${e.lesson.id}`,class:w(["relative z-0 block card cursor-pointer",e.lesson.ativo?"card--interactive":"card--disabled cursor-not-allowed pointer-events-none"]),"aria-disabled":e.lesson.ativo?"false":"true",tabindex:e.lesson.ativo?0:-1,"aria-label":e.lesson.title+(e.lesson.ativo?"":" indisponível")},{default:x(()=>[c("div",J,[c("span",{class:w(["badge self-end",e.lesson.status==="available"?"badge--success":"badge--warning"])},[c("i",{class:w(["flex-shrink-0",e.lesson.status==="available"?"fa-solid fa-circle":"fa-regular fa-clock"])},null,2),c("span",K,h(e.lesson.status==="available"?"Disponível":"Em breve"),1)],2),c("h3",{class:w(["font-bold text-title-large mb-2",e.lesson.ativo?"text-primary-800 dark:text-primary-200":"text-neutral-700 dark:text-neutral-300"])},h(e.lesson.title),3)]),c("p",{class:w(["text-body-medium",e.lesson.ativo?"text-neutral-700 dark:text-neutral-300":"text-disabled"])},h(e.lesson.description),3)]),_:1},8,["to","class","aria-disabled","tabindex","aria-label"])}const X=C(H,[["render",U]]),Q=A({name:"ListaCard",props:{lista:{type:Object,required:!0}},setup(e){const o=y(0),r=y("Progresso não iniciado"),s=(i,d)=>{try{const a=JSON.parse(i);return Array.isArray(a)?a:d}catch{return d}},t=i=>{if(typeof window>"u"||!window.localStorage)return 0;try{const d=localStorage.getItem(`lista_${i}_total`);if(!d)return 0;const a=parseInt(d,10);return Number.isFinite(a)&&a>0?a:0}catch{return 0}},l=()=>{if(!e.lista?.id||typeof window>"u"||!window.localStorage){o.value=0,r.value="Progresso não iniciado";return}const i=`lista_${e.lista.id}`,a=s(localStorage.getItem(`${i}_completed`)||"[]",[]).length,m=t(e.lista.id);if(m>0){const n=Math.min(a/m,1);o.value=Math.round(n*100),r.value=`${a} de ${m} exercícios concluídos`}else a>0?(o.value=0,r.value=`${a} exercícios concluídos`):(o.value=0,r.value="Progresso não iniciado")},p=i=>{if(!i?.key||!e.lista?.id)return;const d=`lista_${e.lista.id}`;(i.key===`${d}_completed`||i.key===`${d}_total`)&&l()};return T(()=>{l(),typeof window<"u"&&window.addEventListener("storage",p)}),B(()=>{typeof window<"u"&&window.removeEventListener("storage",p)}),$(()=>e.lista?.id,()=>l(),{immediate:!0}),{progress:o,progressText:r}}}),W={class:"flex flex-col items-start gap-2"},Y={class:"font-bold text-title-large text-primary-800 dark:text-primary-200 mb-2"},Z={class:"text-body-medium text-neutral-700 dark:text-neutral-300 mb-3"},ee={class:"text-label-small text-neutral-600 dark:text-neutral-400 mb-1"},se=["aria-valuenow"];function te(e,o,r,s,t,l){const p=_("router-link");return f(),v(p,{to:`/exercise/${e.lista.id}`,class:"relative z-0 block card card--interactive cursor-pointer","data-list-id":e.lista.id,"aria-label":`Lista ${e.lista.title}`},{default:x(()=>[c("div",W,[o[0]||(o[0]=c("div",{class:"badge self-end badge--secondary"},[c("i",{class:"flex-shrink-0 fa-solid fa-list"}),c("span",{class:"leading-none"},"Exercícios")],-1)),c("h3",Y,h(e.lista.title),1)]),c("p",Z,h(e.lista.description),1),c("div",ee,h(e.progressText),1),c("div",{class:"progress",role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[c("div",{class:"progress__bar progress__bar--secondary",style:D({width:e.progress+"%"})},null,4)],8,se)]),_:1},8,["to","data-list-id","aria-label"])}const ae=C(Q,[["render",te]]),oe={name:"HomeView",components:{LessonCard:X,ListaCard:ae,SectionBlock:N,GlobalAlert:M,GlobalLoader:G},setup(){const{branding:e}=q(),o=P(),{currentFilter:r,currentViewMode:s}=F(o),t=z(),{loading:l}=F(t),{animateContainer:p}=I(),i=async()=>{await p(".group-grid, #exercises-container",{groupDelay:120,itemDelay:40})},d=()=>{document.querySelectorAll(".group-grid, #exercises-container").forEach(u=>{u.classList.add("layout-fade"),s.value==="list"?(u.classList.remove("grid-cards"),u.classList.add("grid","grid-cols-1","gap-6")):(u.classList.remove("grid","grid-cols-1","gap-6"),u.classList.add("grid-cards")),setTimeout(()=>u.classList.remove("layout-fade"),200)}),i()};T(async()=>{t.loadData(),d(),await i()}),$(s,()=>{d()}),$(r,async()=>{const n=document.documentElement;r.value==="exercises"&&n.classList.remove("legacy-md2"),document.querySelectorAll(".group-grid, #exercises-container").forEach(g=>{g.classList.add("layout-fade"),setTimeout(()=>g.classList.remove("layout-fade"),200)}),await i()});const a=S(()=>{if(r.value==="exercises")return{};const n={};return t.lessons.forEach(u=>{const g=u.unit||"Lessons";n[g]||(n[g]=[]),n[g].push(u)}),n}),m=S(()=>r.value==="lessons"?[]:t.exercises);return{branding:e,loading:l,groupedLessonsView:a,exercisesView:m,currentFilter:r}}},re={id:"cards-container",class:"space-y-8"},ne={class:"group-title section__subtitle"},ie={class:"group-grid relative z-0 grid-cards anim-cards"},le={id:"exercises-container",class:"grid-cards anim-cards"};function ce(e,o,r,s,t,l){const p=_("GlobalLoader"),i=_("GlobalAlert"),d=_("LessonCard"),a=_("SectionBlock"),m=_("ListaCard");return f(),b("div",null,[s.currentFilter!=="exercises"?(f(),v(a,{key:0,id:"home",title:"Aulas",animate:!0,divider:!0},{default:x(()=>[c("div",re,[s.loading?(f(),v(p,{key:0,title:"Carregando aulas...",subtitle:"Preparando o material de estudo."})):Object.keys(s.groupedLessonsView).length===0&&(s.currentFilter==="all"||s.currentFilter==="lessons")?(f(),v(i,{key:1,text:"Nenhuma aula encontrada.",variant:"info",class:"text-center"})):(f(!0),b(k,{key:2},E(s.groupedLessonsView,(n,u)=>(f(),b("div",{key:u,class:"space-y-4"},[c("h3",ne,h(u),1),c("div",ie,[(f(!0),b(k,null,E(n,g=>(f(),v(d,{key:g.id,lesson:g},null,8,["lesson"]))),128))])]))),128))])]),_:1})):L("",!0),s.currentFilter!=="lessons"?(f(),v(a,{key:1,id:"exercises",title:"Lista de Exercícios",tight:!0,animate:!0,divider:!0},{default:x(()=>[c("div",le,[s.loading?(f(),v(p,{key:0,title:"Carregando listas...",subtitle:"Buscando os desafios."})):s.exercisesView.length===0&&(s.currentFilter==="all"||s.currentFilter==="exercises")?(f(),v(i,{key:1,text:"Nenhuma lista encontrada.",variant:"info",class:"col-span-full text-center"})):L("",!0),(f(!0),b(k,null,E(s.exercisesView,n=>(f(),v(m,{key:n.id,lista:n},null,8,["lista"]))),128))])]),_:1})):L("",!0)])}const fe=C(oe,[["render",ce],["__scopeId","data-v-b38cb159"]]);export{fe as default};
