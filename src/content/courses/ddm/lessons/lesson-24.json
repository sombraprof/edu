{
  "formatVersion": "md3.lesson.v1",
  "id": "lesson-24",
  "title": "Aula 24: Testes de UI com Espresso e Compose Testing",
  "slug": "testes-ui-espresso-compose",
  "summary": "Constrói suíte de testes de interface usando Espresso e Compose Testing, integrando ao pipeline de QA colaborativo.",
  "objective": "Automatizar fluxos críticos de UI garantindo regressão mínima e evidências para o squad.",
  "objectives": [
    "Escrever testes Espresso para telas XML legado.",
    "Criar testes Compose usando `composeTestRule`.",
    "Aplicar princípios de acessibilidade e sincronização de idling resources.",
    "Integrar testes ao CI e registrar métricas de cobertura."
  ],
  "competencies": ["Qualidade de software mobile", "Automação de testes", "Colaboração QA-dev"],
  "skills": [
    "Localizar elementos com `onView`/`onNodeWithTag`.",
    "Criar idling resources personalizados.",
    "Capturar screenshots pós-teste.",
    "Publicar relatórios no GitHub Actions."
  ],
  "outcomes": [
    "Suite de testes cobrindo fluxo de login e listagem.",
    "Relatório de cobertura anexado ao Moodle.",
    "Pipeline CI rodando testes automaticamente."
  ],
  "prerequisites": ["Aulas 21-23"],
  "tags": ["android", "tests", "espresso", "compose"],
  "duration": 120,
  "modality": "in-person",
  "resources": [
    {
      "label": "Testing Compose UI",
      "url": "https://developer.android.com/jetpack/compose/testing",
      "type": "guide"
    },
    {
      "label": "Espresso Testing",
      "url": "https://developer.android.com/training/testing/espresso",
      "type": "guide"
    },
    {
      "label": "GitHub Actions for Android",
      "url": "https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-android",
      "type": "guide"
    }
  ],
  "bibliography": [
    "Google. Testing documentation. 2024.",
    "Android Dev BR. Guia de testes Espresso/Compose. 2024.",
    "Testing Google Samples. Now in Android. 2024."
  ],
  "assessment": {
    "type": "formative",
    "description": "Rubrica avalia cobertura, clareza dos testes e integração no CI."
  },
  "content": [
    {
      "type": "videos",
      "title": "Vídeos em português",
      "videos": [
        {
          "url": "https://www.youtube.com/watch?v=RgFnE7o_TN0",
          "title": "Testes de UI com Espresso no Android (Rocketseat Brasil)",
          "caption": "Demonstra como testar fluxos críticos usando Espresso com dicas em português."
        },
        {
          "url": "https://www.youtube.com/watch?v=3wkqkl7tYj4",
          "title": "Compose Testing avançado (Android Dev BR)",
          "caption": "Apresenta composeTestRule, tags e estratégias de sincronização."
        }
      ]
    },
    {
      "type": "flightPlan",
      "title": "Plano da aula",
      "items": [
        "(15 min) Warm-up: revisar bugs recentes detectados via testes manuais.",
        "(30 min) Demo: configurar Espresso + Compose Testing no projeto.",
        "(45 min) Laboratório: escrever testes para login e lista, incluindo idling resources.",
        "(20 min) Integração CI: configurar workflow GitHub Actions.",
        "(10 min) Retro: definir próximos fluxos a automatizar."
      ]
    },
    {
      "type": "callout",
      "variant": "info",
      "title": "Padrões de testes",
      "content": "Nomeie testes como `Given_When_Then`, utilize tags acessíveis (`testTag`) e limpe estado entre execuções."
    },
    {
      "type": "contentBlock",
      "title": "Arquitetura de testes",
      "content": [
        {
          "type": "image",
          "src": "https://developer.android.com/static/images/training/testing/espresso-test-structure.png",
          "alt": "Estrutura de testes Espresso"
        },
        {
          "type": "orderedList",
          "items": [
            {
              "title": "Arrange",
              "text": "Configurar ambiente e dados simulados."
            },
            {
              "title": "Act",
              "text": "Interagir com UI usando Espresso/Compose APIs."
            },
            {
              "title": "Assert",
              "text": "Validar saída e registrar evidências."
            }
          ]
        }
      ]
    },
    {
      "type": "pipelineCanvas",
      "title": "Pipeline de QA automatizado",
      "summary": "Conectar desenvolvimento, testes e evidências em cada sprint.",
      "stages": [
        {
          "id": "planejamento",
          "title": "1. Planejamento",
          "summary": "Selecionar fluxos críticos, definir métricas e ambiente.",
          "status": "in-progress",
          "owners": ["QA", "Mobile"],
          "deliverables": [
            { "id": "matriz", "label": "Matriz de testes" },
            { "id": "dados", "label": "Dados mock" }
          ]
        },
        {
          "id": "execucao",
          "title": "2. Execução",
          "summary": "Escrever testes, rodar localmente e ajustar idling resources.",
          "status": "not-started",
          "owners": ["Mobile"],
          "deliverables": [
            { "id": "suite", "label": "Suite instrumentada" },
            { "id": "report", "label": "Relatório JUnit" }
          ]
        },
        {
          "id": "ci",
          "title": "3. CI/CD",
          "summary": "Integrar pipeline ao GitHub Actions e armazenar evidências.",
          "status": "not-started",
          "owners": ["DevOps", "QA"],
          "deliverables": [
            { "id": "workflow", "label": "Workflow YAML" },
            { "id": "artefatos", "label": "Screenshots e vídeos" }
          ]
        }
      ]
    },
    {
      "type": "callout",
      "variant": "task",
      "title": "TED – Suite automatizada",
      "content": "Implemente testes para login e lista, publique relatório no Actions e envie link + commit `QA_A24` no Moodle."
    }
  ],
  "metadata": {
    "status": "in-review",
    "updatedAt": "2025-02-10T00:00:00.000Z",
    "owners": ["Equipe de Conteúdo DDM"],
    "sources": ["Plano de ensino DDM 2025.2", "Revisão docente fev/2025"]
  }
}
