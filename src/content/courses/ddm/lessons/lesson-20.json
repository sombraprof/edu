{
  "formatVersion": "md3.lesson.v1",
  "id": "lesson-20",
  "title": "Aula 20: Notificações Push e WorkManager",
  "slug": "notificacoes-push-e-workmanager",
  "summary": "Integra Firebase Cloud Messaging, agenda tarefas com WorkManager e aplica boas práticas de UX e privacidade.",
  "objective": "Implementar notificações confiáveis e tarefas em segundo plano alinhadas ao comportamento esperado pela Play Store.",
  "objectives": [
    "Registrar dispositivos no Firebase Cloud Messaging e lidar com tokens.",
    "Configurar WorkManager para sincronização periódica e ações críticas.",
    "Desenhar UX de notificações com canais, prioridade e acessibilidade.",
    "Monitorar entregabilidade usando dashboards e logs estruturados."
  ],
  "competencies": [
    "Arquitetura de mensageria móvel",
    "Trabalho assíncrono em Android",
    "UX writing para notificações"
  ],
  "skills": [
    "Criar canais de notificação com `NotificationCompat`.",
    "Implementar `FirebaseMessagingService` com injeção de dependência.",
    "Agendar Workers com restrições de rede/bateria.",
    "Registrar analytics de cliques e cancelamentos."
  ],
  "outcomes": [
    "App recebe e exibe notificações com deep link funcional.",
    "WorkManager executa tarefa programada com logs e retry controlado.",
    "Dashboard documenta taxa de abertura e erros."
  ],
  "prerequisites": ["Aulas 17–19"],
  "tags": ["android", "firebase", "workmanager", "ux"],
  "duration": 120,
  "modality": "in-person",
  "resources": [
    {
      "label": "Firebase Cloud Messaging",
      "url": "https://firebase.google.com/docs/cloud-messaging",
      "type": "guide"
    },
    {
      "label": "WorkManager",
      "url": "https://developer.android.com/topic/libraries/architecture/workmanager",
      "type": "guide"
    },
    {
      "label": "Notification design",
      "url": "https://developer.android.com/develop/ui/views/notifications",
      "type": "guide"
    }
  ],
  "bibliography": [
    "Google. WorkManager Guides. 2024.",
    "Google. Notification UX Checklist. 2024.",
    "Android Dev BR. Guia de mensageria. 2024."
  ],
  "assessment": {
    "type": "formative",
    "description": "Formulário avaliando clareza, timing e registro de métricas das notificações enviadas."
  },
  "content": [
    {
      "type": "videos",
      "title": "Vídeos em português para mensageria",
      "videos": [
        {
          "url": "https://www.youtube.com/watch?v=Ewh9ERtkLxI",
          "title": "Notificações Android com Firebase Cloud Messaging (Canal Tek Zoom)",
          "caption": "Configuração completa do FCM com exemplos em português."
        },
        {
          "url": "https://www.youtube.com/watch?v=4S-YFQki71s",
          "title": "WorkManager na prática (Android Dev BR)",
          "caption": "Demonstra como agendar workers com restrições e acompanhar status."
        }
      ]
    },
    {
      "type": "lessonPlan",
      "title": "Plano de aula",
      "cards": [
        {
          "title": "Aquecimento",
          "content": "Revisar notificações recentes no celular e identificar quais foram úteis ou spam."
        },
        {
          "title": "Live coding",
          "content": "Implementar FCM + canal + deep link, seguido de Worker para sincronizar dados."
        },
        {
          "title": "Retro",
          "content": "Registrar métricas de entrega e ajustar backlog da sprint."
        }
      ]
    },
    {
      "type": "callout",
      "variant": "warning",
      "title": "LGPD e consentimento",
      "content": "Solicite opt-in explícito para notificações promocionais e registre a escolha do usuário."
    },
    {
      "type": "contentBlock",
      "title": "Diagrama de fluxo",
      "content": [
        {
          "type": "image",
          "src": "https://firebase.google.com/static/docs/cloud-messaging/images/mobile-server-interaction.svg",
          "alt": "Fluxo de mensagens Firebase"
        },
        {
          "type": "unorderedList",
          "items": [
            "Recepção → canal → conteúdo → ação/deep link.",
            "Worker programado → requisição → atualização local → notificação condicional.",
            "Logs → Analytics → painel semanal."
          ]
        }
      ]
    },
    {
      "type": "pipelineCanvas",
      "title": "Pipeline de mensageria",
      "summary": "Garantir entrega confiável, UX clara e observabilidade.",
      "stages": [
        {
          "id": "config",
          "title": "1. Configuração",
          "summary": "Tokens, canais, permissões e tópico padrão.",
          "status": "in-progress",
          "owners": ["Mobile"],
          "deliverables": [
            { "id": "token", "label": "Token registrado" },
            { "id": "canal", "label": "Canais documentados" }
          ]
        },
        {
          "id": "execucao",
          "title": "2. Execução",
          "summary": "Worker e serviço de mensagens implementados com testes.",
          "status": "not-started",
          "owners": ["Mobile", "QA"],
          "deliverables": [
            { "id": "deep", "label": "Deep link testado" },
            { "id": "relatorio", "label": "Planilha de métricas" }
          ]
        },
        {
          "id": "monitoramento",
          "title": "3. Monitoramento",
          "summary": "Acompanhamento de entregabilidade, opt-outs e falhas.",
          "status": "not-started",
          "owners": ["Mobile", "Marketing"],
          "deliverables": [
            { "id": "dashboard", "label": "Dashboard Data Studio" },
            { "id": "playbook", "label": "Playbook de contingência" }
          ]
        }
      ]
    },
    {
      "type": "callout",
      "variant": "task",
      "title": "TED – Push observável",
      "content": "Enviar notificação gatilhada por Worker, registrar métricas em planilha e postar vídeo de 60s mostrando fluxo completo. Commit com tag `NOTIFY_A20`."
    }
  ],
  "metadata": {
    "status": "in-review",
    "updatedAt": "2025-02-10T00:00:00.000Z",
    "owners": ["Equipe de Conteúdo DDM"],
    "sources": ["Plano de ensino DDM 2025.2", "Revisão docente fev/2025"]
  }
}
