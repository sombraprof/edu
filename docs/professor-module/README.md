# Plano de implementa√ß√£o do m√≥dulo administrativo "Professor"

Este documento acompanha a implementa√ß√£o incremental da nova √°rea administrativa voltada a professores e revisores. Ele se apoia nos guias e scripts j√° existentes no reposit√≥rio e detalha entreg√°veis por itera√ß√£o, artefatos esperados e insumos necess√°rios.

## Resumo executivo

- **O que j√° foi entregue**
  - ‚úÖ Roteamento dedicado `/professor` com dashboard inicial protegido pelo modo professor.
  - ‚úÖ _Workbench_ de ingest√£o em `/professor/ingestao` com valida√ß√£o AJV, upload/cola de JSON e checklist operacional.
  - ‚úÖ Documenta√ß√£o viva acompanhando decis√µes, rotinas de governan√ßa e aprendizados da itera√ß√£o 2.
  - ‚úÖ Editor visual em `/professor/editor` com edi√ß√£o de metadados e blocos (`lessonPlan`, `callout`, `cardGrid`, `contentBlock`).
  - ‚úÖ Valida√ß√£o autom√°tica no editor reaproveitando o `lesson.schema.json` para alertar viola√ß√µes do schema durante a edi√ß√£o.
  - ‚úÖ Painel `/professor/validacao` com registro de execu√ß√µes, notas da rodada e importa√ß√£o de relat√≥rios oficiais.
- ‚úÖ Pacote de publica√ß√£o em `/professor/publicacao` para planejar branches, commits, valida√ß√µes e gerar resumo de PR.
- ‚úÖ Bot√£o "Buscar atualiza√ß√µes da main" sincroniza o workspace via backend antes da rodada de commits.
- ‚úÖ Bot√£o "Criar branch automaticamente" prepara a branch de trabalho a partir da `main` diretamente na SPA.
- ‚úÖ Automa√ß√£o de `git add` e `git commit` a partir dos caminhos cadastrados no painel de publica√ß√£o.
- ‚úÖ Envio autom√°tico de `git push` com configura√ß√£o de upstream direto do painel de publica√ß√£o.
- ‚úÖ Servi√ßo auxiliar `npm run teacher:service` exp√µe API local para executar scripts oficiais e sincronizar relat√≥rios com o painel.
  - ‚úÖ Hist√≥rico de execu√ß√µes remotas dispon√≠vel diretamente no painel de valida√ß√£o ao integrar com o `teacher:service`.
  - ‚úÖ Autentica√ß√£o por token no servi√ßo auxiliar para permitir exposi√ß√£o controlada al√©m do ambiente local.

- **Pr√≥ximos passos imediatos**
- üß© Automatizar abertura de PRs diretamente pelo painel de publica√ß√£o.
  - üóÉÔ∏è Definir estrat√©gia de permiss√µes e governan√ßa para expor a API em ambientes compartilhados.
  - üîê Definir pol√≠tica de rota√ß√£o/armazenamento seguro do token do servi√ßo auxiliar.

## Atualiza√ß√£o em curso ‚Äî Itera√ß√£o 2 (Ingest√£o de JSON)

- ‚úÖ Criada a rota `/professor/ingestao` com o _workbench_ de ingest√£o protegido pelo `TeacherModeGate`.
- ‚úÖ Valida√ß√£o client-side via AJV usando os schemas oficiais (`lesson`, manifestos de aulas/exerc√≠cios/suplementos).
- ‚úÖ Checklist operacional para garantir `git checkout main && git pull --rebase` antes de cada rodada.
- ‚úÖ Exporta√ß√£o em JSON formatado + c√≥pia r√°pida para facilitar commits e revis√£o cruzada.
- üìì Registro cont√≠nuo de aprendizados em [`iteration-02.md`](./iteration-02.md).

## Atualiza√ß√£o em curso ‚Äî Itera√ß√£o 3 (Editor visual)

- ‚úÖ Lan√ßado o editor em `/professor/editor` com importa√ß√£o de arquivos e parsing com mensagens de erro amig√°veis.
- ‚úÖ Formul√°rios dedicados para metadados e blocos principais (`lessonPlan`, `callout`, `cardGrid`, `contentBlock`).
- ‚úÖ Exporta√ß√£o com c√≥pia r√°pida e _download_ de arquivo para reaproveitar em commits ou na ingest√£o.
- üöß Amplia√ß√£o da cobertura para blocos avan√ßados e pr√©-visualiza√ß√£o renderizada ainda em an√°lise.
- üìì Registro cont√≠nuo em [`iteration-03.md`](./iteration-03.md).

## Atualiza√ß√£o em curso ‚Äî Itera√ß√£o 4 (Valida√ß√µes & relat√≥rios)

- ‚úÖ Adicionado o painel `/professor/validacao` com campos para anota√ß√µes, sa√≠da dos scripts e registro de execu√ß√µes.
- ‚úÖ Importa√ß√£o de `content-validation-report.json`, `content-observability.json` e `governance-alert.json` com resumos autom√°ticos.
- ‚úÖ Servi√ßo backend local (`npm run teacher:service`) permite disparar scripts oficiais e baixar relat√≥rios sem sair da SPA.
- ‚úÖ Hist√≥rico de execu√ß√µes remotas consumido direto da API (`/api/teacher/scripts/history`).
- ‚úÖ Editor visual sincroniza os alertas registrados e bloqueia exporta√ß√µes com falhas cr√≠ticas.
- üöß Autentica√ß√£o e fila de execu√ß√£o do backend auxiliar em planejamento.
- üìì Registro cont√≠nuo em [`iteration-04.md`](./iteration-04.md).

## Atualiza√ß√£o em curso ‚Äî Itera√ß√£o 5 (Integra√ß√£o com Git)

- ‚úÖ Lan√ßado o pacote `/professor/publicacao` com checklist de valida√ß√µes e gera√ß√£o de comandos para Git/PR.
- ‚úÖ Sugest√£o autom√°tica de mensagem de commit e corpo do PR a partir dos conte√∫dos cadastrados.
- ‚úÖ Integra√ß√£o com o servi√ßo backend para sincronizar status dos scripts obrigat√≥rios e download dos relat√≥rios.
- ‚úÖ Bot√£o "Buscar atualiza√ß√µes da main" aciona `git fetch` via backend e atualiza diverg√™ncias automaticamente.
- ‚úÖ Checkout autom√°tico de branch a partir da `main` via backend para alinhar o workspace antes dos commits.
- ‚úÖ Painel executa `git add` e `git commit` diretamente pela API, reaproveitando o checklist de conte√∫dos cadastrados.
- ‚úÖ Painel envia a branch ativa com `git push`, configurando o upstream na primeira execu√ß√£o quando necess√°rio.
- üöß Backend para abertura de PRs automatizados permanece no roadmap.
- üìì Registro cont√≠nuo em [`iteration-05.md`](./iteration-05.md).

## 1. Mapeamento de requisitos e workflows

### Artefatos de refer√™ncia

- [Guia de autoria de conte√∫do](../CONTENT_AUTHORING_GUIDE.md)
- [Playbook de prompts para LLM](../LLM_PROMPT_PLAYBOOK.md)
- Scripts CLI em [`package.json`](../package.json) (`scaffold:lesson`, `validate:content`, `validate:reports`, etc.)
- Relat√≥rios consolidados em [`reports/`](../../reports)

### A√ß√µes

1. Levantar campos obrigat√≥rios, blocos suportados e metadados de proveni√™ncia exigidos pelos validadores.
2. Mapear pap√©is envolvidos (professor, revisor, coordena√ß√£o) e decis√µes que exigem dupla checagem.
3. Identificar integra√ß√µes externas (reposit√≥rio Git, pipeline de valida√ß√£o) e permiss√µes necess√°rias.

### Entreg√°veis

- Invent√°rio de schemas/blocos com indica√ß√£o de uso no portal atual.
- Matriz RACI preliminar para autoria, revis√£o e publica√ß√£o.
- Checklist de valida√ß√µes obrigat√≥rias antes do commit.

## 2. Arquitetura da solu√ß√£o

### Decis√µes iniciais

- A nova √°rea residir√° em `/professor` dentro da SPA Vue existente.
- O estado de ‚Äúmodo professor‚Äù continua controlado por `useTeacherMode`, garantindo acesso condicionado.
- Um backend auxiliar ser√° avaliado para orquestrar valida√ß√µes e opera√ß√µes Git; por ora, os scripts locais permanecem como fonte de verdade.

### Pr√≥ximos passos

1. Desenhar diagrama de componentes (frontend + backend auxiliar) destacando fluxos de dados.
2. Definir estrat√©gia de workspace local (branches tempor√°rias / patches) para edi√ß√£o antes do commit.
3. Mapear chamadas aos scripts existentes e requisitos de observabilidade (logs, metadados de execu√ß√£o).

## 3. Especifica√ß√£o de UX

### Abordagem

- Reutilizar componentes Material Design 3 j√° adotados (cart√µes, chips, tabelas responsivas).
- Guiar a√ß√µes cr√≠ticas com mensagens orientadas por governan√ßa (proveni√™ncia, valida√ß√µes obrigat√≥rias).

### Entreg√°veis

- Wireframes das sub-rotas principais: dashboard, ingest√£o de JSON, editor de blocos, revis√£o/publica√ß√£o.
- Fluxo de navega√ß√£o incluindo estados vazios e mensagens de erro.
- Lista de componentes reutiliz√°veis e lacunas a preencher (ex.: uploader com pr√©-valida√ß√£o).

## 4. Backend de suporte

### Demandas previstas

- Endpoints REST/CLI para listar cursos e status dos conte√∫dos (aproveitando relat√≥rios existentes).
- Servi√ßo para validar JSONs sob demanda reaproveitando `npm run validate:content`.
- Fun√ß√µes para gerar diffs, preparar pacotes e abrir PRs (ex.: integra√ß√£o com `simple-git`).

### Pr√≥ximos passos

1. Publicar contrato das APIs expostas pelo servi√ßo local [`teacher:service`](./automation-backend.md) e evoluir autentica√ß√£o.
2. Avaliar hospedagem do backend auxiliar (serverless vs. Node dedicado) e impacto em DevOps.
3. Definir pol√≠tica de auditoria/logs para a√ß√µes cr√≠ticas (upload, commit, publica√ß√£o).

## 5. Plano de implementa√ß√£o incremental

| Itera√ß√£o | Escopo                         | Entreg√°veis principais                                                                                | Status          |
| -------- | ------------------------------ | ----------------------------------------------------------------------------------------------------- | --------------- |
| 1        | Roteamento + dashboard inicial | Rota `/professor`, cart√£o de boas-vindas, vis√£o geral das disciplinas e links para guias existentes.  | ‚úÖ Conclu√≠da    |
| 2        | Ingest√£o/valida√ß√£o de JSON     | Workbench `/professor/ingestao`, valida√ß√£o AJV, checklist operacional e documenta√ß√£o viva atualizada. | ‚úÖ Conclu√≠da    |
| 3        | Editor visual                  | Editor baseado em blocos com suporte aos tipos mais comuns e valida√ß√£o inline com Ajv.                | ‚úÖ Conclu√≠da    |
| 4        | Valida√ß√µes & relat√≥rios        | Painel `/professor/validacao` com registro de execu√ß√µes, notas e importa√ß√£o de relat√≥rios oficiais.   | üöß Em andamento |
| 5        | Integra√ß√£o Git                 | Pacote `/professor/publicacao` + automa√ß√µes para branches, diffs e PRs com metadados de proveni√™ncia. | üöß Em andamento |

## 6. Testes e governan√ßa

### Estrat√©gia de testes

- Unit√°rios para componentes de formul√°rio/blocos.
- Testes e2e cobrindo ingest√£o ‚Üí edi√ß√£o ‚Üí valida√ß√£o ‚Üí publica√ß√£o.
- Monitoramento de regress√µes usando stories/documenta√ß√£o viva.

### Governan√ßa

- Checklist obrigat√≥rio antes da publica√ß√£o (metadados, valida√ß√µes rodadas, revis√£o cruzada).
- Auditoria das a√ß√µes realizadas via painel (logs com usu√°rio, hor√°rio, artefatos gerados).
- Pol√≠tica de rollback para conte√∫dos inv√°lidos identificados p√≥s-publica√ß√£o.

---

> **Status:** documento vivo. Atualize a cada itera√ß√£o conclu√≠da adicionando evid√™ncias, decis√µes revisadas e aprendizados.
